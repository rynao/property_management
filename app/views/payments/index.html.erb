<%= render 'layouts/header' %>

<div class='container'>
  <div class='d-flex mt-5'>
    <h4 style="margin-right: 40px;">家賃管理</h4>
    <%=link_to '支払い登録', new_payment_path, class:'btn btn-primary' %>
  </div>
  <div class='row g-3 my-3'>
    <div>
      <div class='d-flex justify-content-center'>
        <h4 class='px-5'><%= link_to '＜', payments_path(month:@month.prev_month)%></h4>
        <h3><%= @month.strftime("%Y年%m月") %></h3>
        <h4 class='px-5'><%= link_to '＞', payments_path(month:@month.next_month)%></h4>
      </div>
      <table class='table'>
        <thead>
          <tr>
            <th>物件名称</th>
            <th>合計家賃</th>
          </tr>
        </thead>
        <tbody>
          <% @building_payments.each do |payment| %>
            <tr>
              <td><%= payment[0] %></td>
              <td><%= payment[1].to_s(:currency, locale: 'jp') %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div style="margin-top:100px;">
      <table class='table'>
        <thead>
          <tr>
            <th>支払い月</th>
            <th>物件名称</th>
            <th>部屋</th>
            <th>家賃</th>
            <th>支払い</th>
          </tr>
        </thead>
        <tbody>
          <% @all_payments.each do |payment| %>
            <tr>
              <td><%= payment.paid_date.strftime("%Y年%m月") %></td>
              <td><%= payment.property.building %></td>
              <td><%= payment.room.name %></td>
              <td><%= payment.amounts.to_s(:currency, locale: 'jp') %></td>
              <% if payment.not_paid %>
                <td style="color:red;">未納</td>
              <% else %>
                <td>○</td>
              <% end %>
              <td>
                <%=link_to '編集', edit_payment_path(payment.id), class:'btn btn-outline-secondary' %>
                <%=link_to '削除', payment_path(payment.id), method: :delete, data: {confirm: "本当に削除しますか？"}, class:'btn btn-outline-secondary' %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

